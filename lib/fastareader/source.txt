Taken shamelessly from https://code.google.com/p/variationtoolkit/source/browse/trunk/src
